{"version":3,"sources":["src/react-dom/dom.js","src/react-dom/render.js","src/react/component.js","src/react/create-element.js","src/react/index.js","src/react-dom/index.js","src/index.js"],"names":["setAttribute","dom","name","value","test","toLowerCase","node","style","cssText","removeAttribute","createComponent","component","props","inst","prototype","render","Component","constructor","unmountComponent","componentWillUnmount","removeNode","base","setComponentProps","componentWillMount","componentWillReceiveProps","renderComponent","renderer","componentWillUpdate","_render","componentDidUpdate","componentDidMount","parentNode","replaceChild","_component","vnode","undefined","String","textNode","document","createTextNode","tag","attrs","createElement","Object","keys","forEach","key","children","child","container","appendChild","state","stateChange","assign","Welcome","React","Counter","num","console","log","setState","ReactDom","getElementById"],"mappings":"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","file":"src.a2b27638.map","sourceRoot":"..","sourcesContent":["export function setAttribute( dom, name, value ) {\n    // 如果属性名是class，则改回className\n    if ( name === 'className' ) name = 'class';\n\n    // 如果属性名是onXXX，则是一个时间监听方法\n    if ( /on\\w+/.test( name ) ) {\n        name = name.toLowerCase();\n        dom[ name ] = value || '';\n    // 如果属性名是style，则更新style对象\n    } else if ( name === 'style' ) {\n        if ( !value || typeof value === 'string' ) {\n            node.style.cssText = value || '';\n        } else if ( value && typeof value === 'object' ) {\n            for ( let name in value ) {\n                // 可以通过style={ width: 20 }这种形式来设置样式，可以省略掉单位px\n                dom.style[ name ] = typeof value[ name ] === 'number' ? value[ name ] + 'px' : value[ name ];\n            }\n        }\n    // 普通属性则直接更新属性\n    } else {\n        if ( name in dom ) {\n            dom[ name ] = value || '';\n        }\n        if ( value ) {\n            dom.setAttribute( name, value );\n        } else {\n            dom.removeAttribute( name, value );\n        }\n    }\n}","import Component from '../react/component'\nimport { setAttribute } from './dom'\n\nfunction createComponent( component, props ) {\n\n    let inst;\n\n    if ( component.prototype && component.prototype.render ) {\n            inst = new component( props );\n      } else {\n            inst = new Component( props );\n            inst.constructor = component;\n            inst.render = function() {\n            return this.constructor( props );\n        }\n      }\n\n    return inst;\n}\n\n// 添加卸载的方法\nfunction unmountComponent( component ) {\n    if ( component.componentWillUnmount ) component.componentWillUnmount();\n    removeNode( component.base);\n}\n\nfunction setComponentProps( component, props ) {\n    // 用来判断是第几次render 第一次走WillMount 其他其实都是走的update\n    if ( !component.base ) {\n            if ( component.componentWillMount ) component.componentWillMount();\n      } else if ( component.componentWillReceiveProps ) {\n            component.componentWillReceiveProps( props );\n      }\n\n    component.props = props;\n\n    renderComponent( component );\n\n}\n\n// renderComponent方法用来渲染组件，setState方法中会直接调用这个方法进行重新渲染，在这个方法里可以实现componentWillUpdate，componentDidUpdate，componentDidMount几个生命周期方法\nexport function renderComponent( component ) {\n\n    let base;\n\n    const renderer = component.render();\n\n    if ( component.base && component.componentWillUpdate ) {\n        component.componentWillUpdate();\n    }\n\n    base = _render( renderer );\n\n    if ( component.base ) {\n        if ( component.componentDidUpdate ) component.componentDidUpdate();\n    } else if ( component.componentDidMount ) {\n        component.componentDidMount();\n    }\n\n    if ( component.base && component.base.parentNode ) {\n        component.base.parentNode.replaceChild( base, component.base );\n    }\n\n    component.base = base;\n    base._component = component;\n\n}\n\nfunction _render( vnode ) {\n\n    if ( vnode === undefined || vnode === null || typeof vnode === 'boolean' ) vnode = '';\n\n    if ( typeof vnode === 'number' ) vnode = String( vnode );\n\n    if ( typeof vnode === 'string' ) {\n        let textNode = document.createTextNode( vnode );\n        return textNode;\n    }\n    // 如果是组件渲染\n    if ( typeof vnode.tag === 'function' ) {\n        const component = createComponent( vnode.tag, vnode.attrs );\n\n        setComponentProps( component, vnode.attrs );\n\n        return component.base;\n    }\n\n    const dom = document.createElement( vnode.tag );\n\n    if ( vnode.attrs ) {\n        Object.keys( vnode.attrs ).forEach( key => {\n\n            const value = vnode.attrs[ key ];\n\n            setAttribute( dom, key, value );\n\n        } );\n    }\n\n    if ( vnode.children ) {\n        vnode.children.forEach( child => render( child, dom ) );\n    }\n\n    return dom;\n}\n\nexport function render( vnode, container ) {\n    return container.appendChild( _render( vnode ) );\n}","import {renderComponent} from '../react-dom/render';\n\n\nclass Component {\n     constructor(props = {}){\n        this.state = {};\n        this.props = props;\n     }\n\n     setState(stateChange){\n         Object.assign(this.state,stateChange);\n         renderComponent(this);\n     }\n}\nexport default Component;","\nfunction createElement( tag, attrs, ...children ) {\n\n    return {\n        tag,\n        attrs,\n        children\n    }\n}\n\nexport default createElement;","\nimport Component from './component.js';\nimport createElement from './create-element.js'\n\n\nexport default{\n    Component,\n    createElement\n}","import {render,renderComponent} from './render';\nexport default {\n    render,\n    renderComponent\n}","import React from './react';\nimport ReactDom from './react-dom';\n\n\nclass Welcome extends React.Component {\n    render() {\n        return <span>Hello, {this.props.name}</span>;\n    }\n}\n\nclass  Counter extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            num:1\n        }\n\n    }\n    componentWillUpdate() {\n        console.log( 'update' );\n    }\n\n    componentWillMount() {\n        console.log( 'mount' );\n    }\n\n    onClick(){\n        this.setState({\n            num:this.state.num + 1\n        })\n    }\n\n    render(){\n        return(\n            <div>\n                <Welcome name=\"sadc\" />\n                {/* <Welcome name=\"lazy\" />\n                <Welcome name=\"safari\" />\n                <h1>hello yishu</h1>\n                <h1>count:{this.state.num}</h1>\n                <button onClick={()=>this.onClick()}>add</button> */}\n            </div>\n        )\n    }\n}\n\n\nReactDom.render(\n    <Counter />,\n    document.getElementById('root')\n)"]}